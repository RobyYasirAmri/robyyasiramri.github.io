<!doctype html><html><head><title>Easy Ways to Monitor Ubuntu VMs Using Node Exporter, Prometheus and Grafana</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><link rel=stylesheet href=/css/bootstrap.min.css><link rel=stylesheet href=/css/layouts/main.css><link rel=stylesheet href=/css/navigators/navbar.css><link rel=stylesheet href=/css/plyr.css><link rel=stylesheet href=/css/flag-icon.min.css><link rel=stylesheet href=/css/katex.min.css><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Muli:wght@300;400;500;600"><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css><link rel=icon type=image/png href=/images/site/BYAMRIcom-favicon_hu3317f8b1d44c2135ae236f455e1a3d15_58339_42x0_resize_box_2.png><meta property="og:title" content="Easy Ways to Monitor Ubuntu VMs Using Node Exporter, Prometheus and Grafana"><meta property="og:description" content="Easy Ways to Monitor Ubuntu VMs Using Node Exporter, Prometheus and Grafana"><meta property="og:type" content="article"><meta property="og:url" content="https://me.byamri.com/posts/5_monitoring/monitoring-vm-1-node-exporter/monitoring-vm-1-node-exporter/"><meta property="article:published_time" content="2022-02-18T08:06:25+06:00"><meta property="article:modified_time" content="2022-02-18T08:06:25+06:00"><meta name=description content="Easy Ways to Monitor Ubuntu VMs Using Node Exporter, Prometheus and Grafana"><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/atom-one-dark.min.css><link rel=stylesheet href=/css/layouts/single.css><link rel=stylesheet href=/css/navigators/sidebar.css><link rel=stylesheet href=/css/style.css></head><body data-spy=scroll data-target=#TableOfContents data-offset=80><div class="container-fluid bg-dimmed wrapper"><nav class="navbar navbar-expand-xl top-navbar final-navbar shadow"><div class=container><button class="navbar-toggler navbar-light" id=sidebar-toggler type=button onclick=toggleSidebar()>
<span class=navbar-toggler-icon></span></button>
<a class=navbar-brand href=/><img src=/images/site/BYAMRIcom-logo_hub0cdfd126a2885dbd6bce6d48a0e1f6f_65018_42x0_resize_box_2.png alt=Logo>
My Resume</a>
<button class="navbar-toggler navbar-light" id=toc-toggler type=button onclick=toggleTOC()>
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse lang-selector" id=top-nav-items><ul class="navbar-nav ml-auto"><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# id=languageSelector role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false><span class="flag-icon flag-icon-gb"></span>English</a><div class=dropdown-menu aria-labelledby=languageSelector><a class="dropdown-item nav-link languages-item" href=/id/posts/5_monitoring/monitoring-vm-1-node-exporter/monitoring-vm-1-node-exporter><span class="flag-icon flag-icon-id"></span>Indonesian</a></div></li></ul></div></div><img src=/images/site/BYAMRIcom-logo_hub0cdfd126a2885dbd6bce6d48a0e1f6f_65018_42x0_resize_box_2.png class=d-none id=main-logo alt=Logo>
<img src=/images/site/BYAMRIcom-logo2_hu2284165ffeb77454cba45acef23638fe_75909_42x0_resize_box_2.png class=d-none id=inverted-logo alt="Inverted Logo"></nav><section class=sidebar-section id=sidebar-section><div class=sidebar-holder><div class=sidebar id=sidebar><form class=mx-auto method=get action=/search><input type=text name=keyword placeholder=Search data-search id=search-box></form><div class=sidebar-tree><ul class=tree id=tree><li id=list-heading><a href=/posts data-filter=all>Posts</a></li><div class=subtree><li><a href=/posts/1_introduction/ title=Introduction>Introduction</a></li><li><i class="fas fa-plus-circle"></i><a href=/posts/2_openstack/>Openstack</a><ul><li><a href=/posts/2_openstack/artikel-1/artikel-1/ title="Openstack Introduction">Openstack Introduction</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/3_kubernetes/>Kubernetes</a><ul><li><a href=/posts/3_kubernetes/1_cara-konfigurasi-ha/cara-konfigurasi-ha/ title="Install Kubernetes HA">Install Kubernetes HA</a></li><li><a href=/posts/3_kubernetes/2_clustering-kube/artikel-2/ title="Clustering Kubernetes using Kubeadm">Clustering Kubernetes using Kubeadm</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/4_docker/>Docker</a><ul><li><a href=/posts/4_docker/artikel-1/artikel-1/ title="Docker Introduction">Docker Introduction</a></li></ul></li><li><i class="fas fa-minus-circle"></i><a class=active href=/posts/5_monitoring/>Monitoring</a><ul class=active><li><a class=active href=/posts/5_monitoring/monitoring-vm-1-node-exporter/monitoring-vm-1-node-exporter/ title="Part I - Monitoring VM on Prometheus and Grafana">Part I - Monitoring VM on Prometheus and Grafana</a></li><li><a href=/posts/5_monitoring/monitoring-vm-2-prometheus/monitoring-vm-prometheus/ title="Part II - Monitoring VM on Prometheus and Grafana">Part II - Monitoring VM on Prometheus and Grafana</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/6_story/>Story Telling</a><ul><li><a href=/posts/6_story/story_telling/story-bandung-traveling/ title="Holiday Story">Holiday Story</a></li></ul></li></div></ul></div></div></div></section><section class=content-section id=content-section><div class=content><div class="container p-0 read-area"><div class="hero-area col-sm-12" id=hero-area style=background-image:url(https://me.byamri.com/images/default-hero.jpg)></div><div class=page-content><div class="author-profile ml-auto align-self-lg-center"><img class=rounded-circle src=/images/author/me2_hu6449058ebe31352b620a6ee237336747_560239_120x120_fit_box_2.png alt="Author Image"><h5 class=author-name>Roby Yasir Amri</h5><p>:date_full</p></div><div class=title><h1>Easy Ways to Monitor Ubuntu VMs Using Node Exporter, Prometheus and Grafana</h1></div><div class=taxonomy-terms><ul><li class=rounded><a href=/tags/kubernetes class="btn, btn-sm">Kubernetes</a></li><li class=rounded><a href=/tags/linux class="btn, btn-sm">Linux</a></li></ul></div><div class=post-content id=post-content><p>Halo Gaes,
Pada jurnal kali ini kita akan coba untuk menginstall Node Exporter pada Ubuntu dan mem-visualisasikan hasil dari metric Node Exporter tersebut kedalam Dashboard Grafana. Secara garis besar Node Exporter disini berfungsi sebagai agent untuk mengubah data-data pada server menjadi metric, kemudian metrics tersebut kita lempar ke Prometheus dan di visualisasikan metric itu kedalam Dashboard Grafana agar lebih mudah dalam membacanya.
Untuk lab kali ini hal-hal yang akan kita lakukan yaitu:</p><ol><li>Install Node Exporter di setiap VM/Instances</li><li>Install Prometheus disalah satu VM/Instances</li><li>Install dan configure Grafana</li><li>Import Dashboard Grafana</li></ol><p>Pada lab ini kita masih menggunakan environtment dari lab yang sebelumnya, jadi untuk topologi yang digunakan masih sama. Install dan konfigurasi Prometheus dan Grafana dilakukan di VM rb-k8s-lb1</p><img src=/posts/3_kubernetes/1_cara-konfigurasi-ha/topologi-ha-kubernetes.png alt=Topologi width=600 height=700 class=center><h2 id=install-node-exporter-di-setiap-vminstances>Install Node Exporter di setiap VM/Instances</h2><p>Okay, kita langsung saja ke step pertama yaitu install node exporter di semua VM/instances, kenapa? karena tujuan kita yaitu untuk memonitor resources semua VM tersebut, skuyy!</p><ol><li>Langkah yang pertama harus kita lakukan yaitu install Node exporternya dengan command:</li></ol><pre><code>wget https://github.com/prometheus/node_exporter/releases/download/v1.3.1/node_exporter-1.3.1.linux-amd64.tar.gz
</code></pre><ol start=2><li>Setelah kita download kemudian kita ekstrak file tersebut dengan command:</li></ol><pre><code>tar xvfz node_exporter-1.3.1.linux-amd64.tar.gz
</code></pre><ol start=3><li>Kemudian untuk memudahkan kita dalam proses intallasi karena kita tentu tidak akan melakukan install paket node exporter tersebut secara manual satu persatu, kita bisa lakukan menggunakan script. Untuk script pertama kita siapkan daftar list IP VM mana saja yang akan kita install node exporter. kita beri file dengan nama ip-list.txt</li></ol><pre><code>sudo nano ip-list.txt
</code></pre><pre><code>10.60.60.43
10.60.60.44
10.60.60.51
10.60.60.52
10.60.60.53
10.60.60.54
10.60.60.55
10.60.60.56
</code></pre><ol start=4><li>Lalu kita bikin script untuk install node_exporter tadi, kita namakan script ini add-node-exporter.sh</li></ol><pre><code>sudo nano add-node-exporter.sh
</code></pre><ol start=5><li>Kemudian kita bikin service node_exporter dengan nama node_exporter.service</li></ol><pre><code>sudo nano node_exporter.service
</code></pre><pre><code>[Unit]
Description=Node Exporter
After=network.target

[Service]
User=root
Group=root
Type=simple
ExecStart=/usr/local/bin/node_exporter

[Install]
WantedBy=multi-user.target
</code></pre><ol start=6><li>Sampai sini kita harusnya sudah mempunyai 3 file, yaitu add-node-exporter.sh node_exporter.service dan add-node-exporter.sh. Kemudian kita bikin script untuk mentransfer file semua script tadi ke masing-masing VM. Kita beri nama file ini dengan nama transfer-node-exporter.sh</li></ol><pre><code>sudo nano transfer-node-exporter.sh
</code></pre><pre><code>#!/bin/bash

for i in $(cat ip-list.txt) 
do 
	echo &quot;#### Execute On $i ####&quot;
	scp node_exporter node_exporter.service add-node-exporter.sh $i:~/
done
</code></pre><ol start=7><li>Setelah file siap. kita tinggal jalankan script transfer-node-exporter.sh dengan cara:</li></ol><pre><code>sudo chmod +x transfer-node-exporter.sh
sudo ./transfer-node-exporter.sh
</code></pre><ol start=8><li>Jika semua file telah di transfer ke masing-masing VM, kita siapkan satu script lagi untuk install node exporternya. kita namakan file ini dengan install-node-exporter.sh</li></ol><pre><code>sudo nano install-node-exporter.sh
</code></pre><pre><code>#!/bin/bash

for i in $(cat ip-list.txt) 
do 
	echo &quot;#### Installing On $i ####&quot;
	ssh $i bash add-node-exporter.sh systemctl status node_exporter.service
done
</code></pre><ol start=9><li>Untuk mulai install node exporter di semua VM, kita cukup menggunakan file yang terakhir saja karena file sebelumnya kita sudah copy ke masing-masing VM:</li></ol><pre><code>sudo chmod +x install-node-exporter.sh
./install-node-exporter.sh
</code></pre><p>Apabila kita ingin menginstal node exporter di kemudian hari dengan jumlah VM yang lumayan banyak, kita tinggal rubah saja untuk list IPnya pada file IP-list.txt, kemudian kita transfer semua file menggunakan script transfer-node-exporter.sh lalu kita bisa jalankan script install-node-exporter.sh untuk langsung mulai install di semua VM.</p><h2 id=verifikasi>Verifikasi</h2><p>Untuk memverifikasi hasil install node-exporter dapat kita lakukan dengan menggunakan command:</p><pre><code>root@rb-k8s-lb1:~# sudo systemctl status node_exporter.service 
● node_exporter.service - Node Exporter
     Loaded: loaded (/etc/systemd/system/node_exporter.service; disabled; vendor preset: enabled)
     Active: active (running) since Wed 2022-02-02 16:24:00 UTC; 1 months 6 days ago
   Main PID: 2006 (node_exporter)
      Tasks: 10 (limit: 4676)
     Memory: 22.4M
     CGroup: /system.slice/node_exporter.service
             └─2006 /usr/local/bin/node_exporter

Feb 02 16:24:00 rb-k8s-lb1 node_exporter[2006]: ts=2022-02-02T16:24:00.253Z caller=node_exporter.go:115 level=info collector=thermal_zone
Feb 02 16:24:00 rb-k8s-lb1 node_exporter[2006]: ts=2022-02-02T16:24:00.253Z caller=node_exporter.go:115 level=info collector=time
Feb 02 16:24:00 rb-k8s-lb1 node_exporter[2006]: ts=2022-02-02T16:24:00.253Z caller=node_exporter.go:115 level=info collector=timex
Feb 02 16:24:00 rb-k8s-lb1 node_exporter[2006]: ts=2022-02-02T16:24:00.253Z caller=node_exporter.go:115 level=info collector=udp_queues
Feb 02 16:24:00 rb-k8s-lb1 node_exporter[2006]: ts=2022-02-02T16:24:00.253Z caller=node_exporter.go:115 level=info collector=uname
Feb 02 16:24:00 rb-k8s-lb1 node_exporter[2006]: ts=2022-02-02T16:24:00.253Z caller=node_exporter.go:115 level=info collector=vmstat
Feb 02 16:24:00 rb-k8s-lb1 node_exporter[2006]: ts=2022-02-02T16:24:00.253Z caller=node_exporter.go:115 level=info collector=xfs
Feb 02 16:24:00 rb-k8s-lb1 node_exporter[2006]: ts=2022-02-02T16:24:00.253Z caller=node_exporter.go:115 level=info collector=zfs
Feb 02 16:24:00 rb-k8s-lb1 node_exporter[2006]: ts=2022-02-02T16:24:00.254Z caller=node_exporter.go:199 level=info msg=&quot;Listening on&quot; address=:9100
Feb 02 16:24:00 rb-k8s-lb1 node_exporter[2006]: ts=2022-02-02T16:24:00.254Z caller=tls_config.go:195 level=info msg=&quot;TLS is disabled.&quot; http2=false
root@rb-k8s-lb1:~# 
</code></pre><p>atau bisa menggunakan perintah curl melalui terminal</p><pre><code>root@rb-k8s-lb1:~# curl localhost:9100 -k 
</code></pre></div><div class="row pl-3 pr-3"><div class="col-md-6 share-buttons"><strong>Share on:</strong>
<a class="btn btn-sm facebook-btn" href="https://www.facebook.com/sharer.php?u=https%3a%2f%2fme.byamri.com%2fposts%2f5_monitoring%2fmonitoring-vm-1-node-exporter%2fmonitoring-vm-1-node-exporter%2f" target=_blank><i class="fab fa-facebook"></i></a><a class="btn btn-sm twitter-btn" href="https://twitter.com/share?url=https%3a%2f%2fme.byamri.com%2fposts%2f5_monitoring%2fmonitoring-vm-1-node-exporter%2fmonitoring-vm-1-node-exporter%2f&text=Easy%20Ways%20to%20Monitor%20Ubuntu%20VMs%20Using%20Node%20Exporter%2c%20Prometheus%20and%20Grafana&via=My%20Resume" target=_blank><i class="fab fa-twitter"></i></a><a class="btn btn-sm reddit-btn" href="https://reddit.com/submit?url=https%3a%2f%2fme.byamri.com%2fposts%2f5_monitoring%2fmonitoring-vm-1-node-exporter%2fmonitoring-vm-1-node-exporter%2f&title=Easy%20Ways%20to%20Monitor%20Ubuntu%20VMs%20Using%20Node%20Exporter%2c%20Prometheus%20and%20Grafana" target=_blank><i class="fab fa-reddit"></i></a><a class="btn btn-sm linkedin-btn" href="https://www.linkedin.com/shareArticle?url=https%3a%2f%2fme.byamri.com%2fposts%2f5_monitoring%2fmonitoring-vm-1-node-exporter%2fmonitoring-vm-1-node-exporter%2f&title=Easy%20Ways%20to%20Monitor%20Ubuntu%20VMs%20Using%20Node%20Exporter%2c%20Prometheus%20and%20Grafana" target=_blank><i class="fab fa-linkedin"></i></a><a class="btn btn-sm whatsapp-btn" href="https://api.whatsapp.com/send?text=Easy%20Ways%20to%20Monitor%20Ubuntu%20VMs%20Using%20Node%20Exporter%2c%20Prometheus%20and%20Grafana https%3a%2f%2fme.byamri.com%2fposts%2f5_monitoring%2fmonitoring-vm-1-node-exporter%2fmonitoring-vm-1-node-exporter%2f" target=_blank><i class="fab fa-whatsapp"></i></a><a class="btn btn-sm email-btn" href="mailto:?subject=Easy%20Ways%20to%20Monitor%20Ubuntu%20VMs%20Using%20Node%20Exporter%2c%20Prometheus%20and%20Grafana&body=https%3a%2f%2fme.byamri.com%2fposts%2f5_monitoring%2fmonitoring-vm-1-node-exporter%2fmonitoring-vm-1-node-exporter%2f" target=_blank><i class="fas fa-envelope-open-text"></i></a></div><div class="col-md-6 btn-improve-page"><a href=https://github.com/RobyYasirAmri/robyyasiramri.github.io/edit/main/content/posts/5_monitoring/monitoring-vm-1-node-exporter/monitoring-vm-1-node-exporter.md title="Improve this page" target=_blank rel=noopener><i class="fas fa-code-branch"></i>Improve this page</a></div></div><hr><div class="row next-prev-navigator"><div class="col-md-6 previous-article"><a href=/posts/4_docker/artikel-1/artikel-1/ title="Docker Introduction" class="btn btn-outline-info"><div><i class="fas fa-chevron-circle-left"></i>Prev</div><div class=next-prev-text>Docker Introduction</div></a></div><div class="col-md-6 next-article"><a href=/posts/5_monitoring/monitoring-vm-2-prometheus/monitoring-vm-prometheus/ title="Easy Ways to Monitor Ubuntu VMs Using Node Exporter, Prometheus and Grafana - Part II" class="btn btn-outline-info"><div>Next <i class="fas fa-chevron-circle-right"></i></div><div class=next-prev-text>Easy Ways to Monitor Ubuntu VMs Using Node Exporter, Prometheus and Grafana - Part II</div></a></div></div><hr></div></div></div><a id=scroll-to-top class=btn><i class="fas fa-chevron-circle-up"></i></a><div class="dropdown languageSelector"><a class="btn dropdown-toggle" href=# id=languageSelector role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false><span class="flag-icon flag-icon-gb"></span>English</a><div class=dropdown-menu aria-labelledby=languageSelector><a class="dropdown-item nav-link languages-item" href=/id/posts/5_monitoring/monitoring-vm-1-node-exporter/monitoring-vm-1-node-exporter><span class="flag-icon flag-icon-id"></span>Indonesian</a></div></div></section><section class=toc-section id=toc-section><div class=toc-holder><h5 class="text-center pl-3">Table of Contents</h5><hr><div class=toc><nav id=TableOfContents><ul><li><a href=#install-node-exporter-di-setiap-vminstances>Install Node Exporter di setiap VM/Instances</a></li><li><a href=#verifikasi>Verifikasi</a></li></ul></nav></div></div></section></div><footer class="container-fluid text-center align-content-center footer pb-2"><div class="container pt-5"><div class="row text-left"><div class="col-md-4 col-sm-12"><h5>Navigation</h5><ul><li class=nav-item><a class=smooth-scroll href=https://me.byamri.com#about>About</a></li><li class=nav-item><a class=smooth-scroll href=https://me.byamri.com#skills>Skills</a></li><li class=nav-item><a class=smooth-scroll href=https://me.byamri.com#experiences>Experiences</a></li><li class=nav-item><a class=smooth-scroll href=https://me.byamri.com#education>Education</a></li><li class=nav-item><a class=smooth-scroll href=https://me.byamri.com#projects>Projects</a></li><li class=nav-item><a class=smooth-scroll href=https://me.byamri.com#recent-posts>Recent Posts</a></li></ul></div><div class="col-md-4 col-sm-12"><h5>Contact me:</h5><ul><li><a href=mailto:roby@byamri.com target=_blank rel=noopener><span><i class="fas fa-envelope"></i></span><span>roby@byamri.com</span></a></li></ul></div><div class="col-md-4 col-sm-12"><p>Stay up to date with email notification</p><form action="https://github.us1.list-manage.com/subscribe/post?u=19de52a4603135aae97163fd8&amp;amp;id=094a24c76e" method=post id=mc-embedded-subscribe-form name=mc-embedded-subscribe-form class=validate target=_blank novalidate><div class=form-group><input type=email class=form-control id=mce-EMAIL name=EMAIL aria-describedby=emailHelp placeholder="Enter email">
<small id=emailHelp class="form-text text-muted">By entering your email address, you agree to receive the newsletter of this website.</small></div><button type=submit class="btn btn-info">Submit</button></form></div></div></div><hr><div class=container><p id=disclaimer><strong>Liability Notice:</strong> This theme is under MIT license. So, you can use it for non-commercial, commercial, or private uses. You can modify or distribute the theme without requiring any permission from the theme author. However, the theme author does not provide any warranty or takes any liability for any issue with the theme.</p></div><hr><div class=container><div class="row text-left"><div class=col-md-4><a id=theme href=https://github.com/hossainemruz/toha target=_blank rel=noopener><img src=/images/theme-logo_hu8376fd15465fef26ffe66b6bcf0ca686_13669_32x0_resize_box_2.png alt="Toha Theme Logo">
Toha</a></div><div class="col-md-4 text-center">© 2022 Copyright.</div><div class="col-md-4 text-right"><a id=hugo href=https://gohugo.io/ target=_blank rel=noopener>Powered by
<img src=/images/hugo-logo.svg alt="Hugo Logo" height=18></a></div></div></div></footer><script type=text/javascript src=/js/jquery-3.4.1.min.js></script><script type=text/javascript src=/js/popper.min.js></script><script type=text/javascript src=/js/bootstrap.min.js></script><script type=text/javascript src=/js/navbar.js></script><script type=text/javascript src=/js/plyr.js></script><script type=text/javascript src=/js/main.js></script><script type=text/javascript defer src=/js/katex.min.js></script><script type=text/javascript defer src=/js/auto-render.min.js onload=renderMathInElement(document.body);></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js></script><script src=/js/single.js></script><script>hljs.initHighlightingOnLoad();</script></body></html>