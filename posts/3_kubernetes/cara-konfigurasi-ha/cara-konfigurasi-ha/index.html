<!doctype html><html><head><title>How to Configure High Availabilty Kubernetes Cluster on Ubuntu 20.4</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><link rel=stylesheet href=/css/bootstrap.min.css><link rel=stylesheet href=/css/layouts/main.css><link rel=stylesheet href=/css/navigators/navbar.css><link rel=stylesheet href=/css/plyr.css><link rel=stylesheet href=/css/flag-icon.min.css><link rel=stylesheet href=/css/katex.min.css><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Muli:wght@300;400;500;600"><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css><link rel=icon type=image/png href=/images/site/BYAMRIcom-favicon_hu3317f8b1d44c2135ae236f455e1a3d15_58339_42x0_resize_box_2.png><meta property="og:title" content="How to Configure High Availabilty Kubernetes Cluster on Ubuntu 20.4"><meta property="og:description" content="Configure High Availability Kubernetes HAproxy"><meta property="og:type" content="article"><meta property="og:url" content="https://me.byamri.com/posts/3_kubernetes/cara-konfigurasi-ha/cara-konfigurasi-ha/"><meta property="article:published_time" content="2022-02-13T08:06:25+06:00"><meta property="article:modified_time" content="2022-02-13T08:06:25+06:00"><meta name=description content="Configure High Availability Kubernetes HAproxy"><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/atom-one-dark.min.css><link rel=stylesheet href=/css/layouts/single.css><link rel=stylesheet href=/css/navigators/sidebar.css><link rel=stylesheet href=/css/style.css></head><body data-spy=scroll data-target=#TableOfContents data-offset=80><div class="container-fluid bg-dimmed wrapper"><nav class="navbar navbar-expand-xl top-navbar final-navbar shadow"><div class=container><button class="navbar-toggler navbar-light" id=sidebar-toggler type=button onclick=toggleSidebar()>
<span class=navbar-toggler-icon></span></button>
<a class=navbar-brand href=/><img src=/images/site/BYAMRIcom-logo_hub0cdfd126a2885dbd6bce6d48a0e1f6f_65018_42x0_resize_box_2.png alt=Logo>
My Resume</a>
<button class="navbar-toggler navbar-light" id=toc-toggler type=button onclick=toggleTOC()>
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse lang-selector" id=top-nav-items><ul class="navbar-nav ml-auto"><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# id=languageSelector role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false><span class="flag-icon flag-icon-gb"></span>English</a><div class=dropdown-menu aria-labelledby=languageSelector><a class="dropdown-item nav-link languages-item" href=/id/posts/3_kubernetes/cara-konfigurasi-ha/cara-konfigurasi-ha><span class="flag-icon flag-icon-id"></span>Indonesian</a></div></li></ul></div></div><img src=/images/site/BYAMRIcom-logo_hub0cdfd126a2885dbd6bce6d48a0e1f6f_65018_42x0_resize_box_2.png class=d-none id=main-logo alt=Logo>
<img src=/images/site/BYAMRIcom-logo2_hu2284165ffeb77454cba45acef23638fe_75909_42x0_resize_box_2.png class=d-none id=inverted-logo alt="Inverted Logo"></nav><section class=sidebar-section id=sidebar-section><div class=sidebar-holder><div class=sidebar id=sidebar><form class=mx-auto method=get action=/search><input type=text name=keyword placeholder=Search data-search id=search-box></form><div class=sidebar-tree><ul class=tree id=tree><li id=list-heading><a href=/posts data-filter=all>Posts</a></li><div class=subtree><li><a href=/posts/1_introduction/ title=Introduction>Introduction</a></li><li><i class="fas fa-plus-circle"></i><a href=/posts/2_openstack/>Openstack</a><ul><li><a href=/posts/2_openstack/artikel-1/artikel-1/ title="Openstack Introduction">Openstack Introduction</a></li></ul></li><li><i class="fas fa-minus-circle"></i><a class=active href=/posts/3_kubernetes/>Kubernetes</a><ul class=active><li><a class=active href=/posts/3_kubernetes/cara-konfigurasi-ha/cara-konfigurasi-ha/ title="Install Kubernetes HA">Install Kubernetes HA</a></li><li><a href=/posts/3_kubernetes/artikel-2/artikel-2/ title="Clustering Kubernetes using Kubeadm">Clustering Kubernetes using Kubeadm</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/4_docker/>Docker</a><ul><li><a href=/posts/4_docker/artikel-1/artikel-1/ title="Docker Introduction">Docker Introduction</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/5_monitoring/>Monitoring</a><ul><li><a href=/posts/5_monitoring/monitoring-vm-1-node-exporter/monitoring-vm-1-node-exporter/ title="Part I - Monitoring VM on Prometheus and Grafana">Part I - Monitoring VM on Prometheus and Grafana</a></li><li><a href=/posts/5_monitoring/monitoring-vm-2-prometheus/monitoring-vm-prometheus/ title="Part II - Monitoring VM on Prometheus and Grafana">Part II - Monitoring VM on Prometheus and Grafana</a></li></ul></li></div></ul></div></div></div></section><section class=content-section id=content-section><div class=content><div class="container p-0 read-area"><div class="hero-area col-sm-12" id=hero-area style=background-image:url(https://me.byamri.com/images/default-hero.jpg)></div><div class=page-content><div class="author-profile ml-auto align-self-lg-center"><img class=rounded-circle src=/images/author/me2_hu6449058ebe31352b620a6ee237336747_560239_120x120_fit_box_2.png alt="Author Image"><h5 class=author-name>Roby Yasir Amri</h5><p>:date_full</p></div><div class=title><h1>How to Configure High Availabilty Kubernetes Cluster on Ubuntu 20.4</h1></div><div class=taxonomy-terms><ul><li class=rounded><a href=/tags/kubernetes class="btn, btn-sm">Kubernetes</a></li><li class=rounded><a href=/tags/linux class="btn, btn-sm">Linux</a></li></ul></div><div class=post-content id=post-content><p>On this occasion I will share how to configure High Availability Cluster Kubernetes on Ubuntu using HAProxy and Keepalive. We use Keepalive and HAproxy for load balancing and high availability. Things that need to be prepared include:</p><ol><li>Hosts/Instances/VM</li><li>Configure HAproxy and Keepalive</li><li>Configure Kubernetes clustering using Kubeadm.</li></ol><h2 id=architecture-clusters>Architecture Clusters.</h2><p>Here we use 3 masters, 3 workers, 2 load balancers, and 1 IP to be used as a Virtual IP Address. VIP means that if an error occurs or 1 node dies, the IP can be forwarded to the node that allows flaiover to occur, so that High Availability is achieved according to our current lab goals.</p><img src=/posts/kubernetes/topologi-ha-kubernetes.png alt=Topologi width=600 height=700 class=center><div style=margin-top:3rem></div><p>It should be underlined, that HAproxy and Keepalive are not installed on the master node. HAproxy and Keepalive are only installed on loadbalancer1 and loadbalancer2 nodes</p><p>Hosts used:</p><table><thead><tr><th>Hostname</th><th>IP Address</th><th>Roles</th></tr></thead><tbody><tr><td>rb-k8s-lb1</td><td>10.60.60.43</td><td>HAproxy & Keepalived</td></tr><tr><td>rb-k8s-lb2</td><td>10.60.60.44</td><td>HAproxy & Keepalived</td></tr><tr><td>rb-k8s-master1</td><td>10.60.60.51</td><td>master, etcd</td></tr><tr><td>rb-k8s-master2</td><td>10.60.60.52</td><td>master, etcd</td></tr><tr><td>rb-k8s-master3</td><td>10.60.60.53</td><td>master, etcd</td></tr><tr><td>rb-k8s-worker1</td><td>10.60.60.54</td><td>worker</td></tr><tr><td>rb-k8s-worker2</td><td>10.60.60.55</td><td>worker</td></tr><tr><td>rb-k8s-worker3</td><td>10.60.60.56</td><td>worker</td></tr><tr><td>-</td><td>10.60.60.45</td><td>VirtualIP</td></tr></tbody></table><h2 id=load-balancing-configuration>Load Balancing Configuration:</h2><p>Keepalived and HAproxy are installed on nodes rb-k8s-lb1 and rb-k8s-lb2. In this scenario, if one of the loadbalancer nodes is down/dead, Virtual IP will automatically use the path on the loadbalancer node that is running so that the Kubernetes cluster does not experience an error.</p><h3 id=install-keepalive-and-haproxy-on-both-nodes>Install Keepalive and HAproxy on both nodes</h3><ol><li>Run on nodes rb-k8s-lb1 and rb-k8s-lb2:</li></ol><pre><code>sudo apt install keepalived haproxy psmisc -y
</code></pre><ol start=2><li>Configure haproxy on both loadbalancer nodes:</li></ol><pre><code>sudo vi /etc/haproxy/haproxy.cfg
</code></pre><pre><code>global
    log /dev/log  local0 warning
    chroot      /var/lib/haproxy
    pidfile     /var/run/haproxy.pid
    maxconn     4000
    user        haproxy
    group       haproxy
    daemon
   
   stats socket /var/lib/haproxy/stats
   
defaults
  log global
  option  httplog
  option  dontlognull
        timeout connect 5000
        timeout client 50000
        timeout server 50000
   
frontend kube-apiserver
  bind *:6443
  mode tcp
  option tcplog
  default_backend kube-apiserver
   
backend kube-apiserver
    mode tcp
    option tcplog
    option tcp-check
    balance roundrobin
    default-server inter 10s downinter 5s rise 2 fall 2 slowstart 60s maxconn 250 maxqueue 256 weight 100
    server rb-k8s-master1 10.60.60.51:6443 check # Replace the IP address with your own.
    server rb-k8s-master2 10.60.60.52:6443 check # Replace the IP address with your own.
    server rb-k8s-master3 10.60.60.53:6443 check # Replace the IP address with your own.
</code></pre><ol start=3><li>Restart service HAproxy:</li></ol><pre><code>sudo systemctl restart haproxy
</code></pre><ol start=4><li>Then restart and enable the HAproxy service:</li></ol><pre><code>sudo systemctl enable haproxy
sudo systemctl restart haproxy
</code></pre><ol start=5><li>Make sure the HAproxy service is active:</li></ol><pre><code>root@rb-k8s-lb1:~# systemctl status haproxy.service 
‚óè haproxy.service - HAProxy Load Balancer
     Loaded: loaded (/lib/systemd/system/haproxy.service; enabled; vendor preset: enabled)
     Active: active (running) since Sat 2022-02-12 17:29:05 UTC; 10min ago
       Docs: man:haproxy(1)
             file:/usr/share/doc/haproxy/configuration.txt.gz
    Process: 463986 ExecStartPre=/usr/sbin/haproxy -f $CONFIG -c -q $EXTRAOPTS (code=exited, status=0/SUCCESS)
   Main PID: 464001 (haproxy)
      Tasks: 5 (limit: 4676)
     Memory: 3.6M
     CGroup: /system.slice/haproxy.service
             ‚îú‚îÄ464001 /usr/sbin/haproxy -Ws -f /etc/haproxy/haproxy.cfg -p /run/haproxy.pid -S /run/haproxy-master.sock
             ‚îî‚îÄ464002 /usr/sbin/haproxy -Ws -f /etc/haproxy/haproxy.cfg -p /run/haproxy.pid -S /run/haproxy-master.sock

Feb 12 17:29:05 rb-k8s-lb1 systemd[1]: Starting HAProxy Load Balancer...
Feb 12 17:29:05 rb-k8s-lb1 haproxy[464001]: [WARNING] 042/172905 (464001) : parsing [/etc/haproxy/haproxy.cfg:28] : backend 'kube-apiserver' &gt;
Feb 12 17:29:05 rb-k8s-lb1 haproxy[464001]: [NOTICE] 042/172905 (464001) : New worker #1 (464002) forked
Feb 12 17:29:05 rb-k8s-lb1 systemd[1]: Started HAProxy Load Balancer.
Feb 12 17:29:08 rb-k8s-lb1 haproxy[464002]: [WARNING] 042/172908 (464002) : Server kube-apiserver/rb-k8s-master2 is DOWN, reason: Layer4 conn&gt;
Feb 12 17:29:12 rb-k8s-lb1 haproxy[464002]: [WARNING] 042/172912 (464002) : Server kube-apiserver/rb-k8s-master3 is DOWN, reason: Layer4 conn&gt;
</code></pre><h3 id=keepalive-configuration>Keepalive Configuration</h3><ol><li>Configure keepalive on both nodes rb-k8s-lb1 and rb-k8s-lb2:</li></ol><pre><code>sudo /etc/keepalived/keepalived.conf
</code></pre><p>Configure keepalive.conf on rb-k8s-lb1:</p><pre><code>global_defs {
  notification_email {
  }
  router_id LVS_DEVEL
  vrrp_skip_check_adv_addr
  vrrp_garp_interval 0
  vrrp_gna_interval 0
}
   
vrrp_script chk_haproxy {
  script &quot;killall -0 haproxy&quot;
  interval 2
  weight 2
}
   
vrrp_instance haproxy-vip {
  state BACKUP
  priority 100
  interface ens3                       # Network card
  virtual_router_id 60
  advert_int 1
  authentication {
    auth_type PASS
    auth_pass 1111
  }
  unicast_src_ip 10.60.60.43      # The IP address of this machine rb-k8s-lb1
  unicast_peer {
    10.60.60.44                         # The IP address of peer machines rb-k8s-lb2
  }
   
  virtual_ipaddress {
    10.60.60.45/24                  # The VIP address
  }
   
  track_script {
    chk_haproxy
  }
}
</code></pre><p>Configure keepalive.conf on rb-k8s-lb2:</p><pre><code>global_defs {
  notification_email {
  }
  router_id LVS_DEVEL
  vrrp_skip_check_adv_addr
  vrrp_garp_interval 0
  vrrp_gna_interval 0
}
   
vrrp_script chk_haproxy {
  script &quot;killall -0 haproxy&quot;
  interval 2
  weight 2
}
   
vrrp_instance haproxy-vip {
  state BACKUP
  priority 100
  interface ens3                       # Network card
  virtual_router_id 60
  advert_int 1
  authentication {
    auth_type PASS
    auth_pass 1111
  }
  unicast_src_ip 10.60.60.44      # The IP address of this machine rb-k8s-lb2
  unicast_peer {
    10.60.60.43                         # The IP address of peer machines rb-k8s-lb1
  }
   
  virtual_ipaddress {
    10.60.60.45/24                  # The VIP address
  }
   
  track_script {
    chk_haproxy
  }
}
</code></pre><ol start=3><li>Then restart and enable the keepalive service</li></ol><pre><code>sudo systemctl enable keepalived
sudo systemctl restart keepalived
</code></pre><ol start=4><li>Make sure the service keepalived is running
Status keepalived on rb-k8s-lb1:</li></ol><pre><code>root@rb-k8s-lb1:~# sudo systemctl status keepalived.service 
‚óè keepalived.service - Keepalive Daemon (LVS and VRRP)
     Loaded: loaded (/lib/systemd/system/keepalived.service; enabled; vendor preset: enabled)
     Active: active (running) since Wed 2022-02-02 16:07:10 UTC; 1 weeks 3 days ago
   Main PID: 647 (keepalived)
      Tasks: 2 (limit: 4676)
     Memory: 6.5M
     CGroup: /system.slice/keepalived.service
             ‚îú‚îÄ647 /usr/sbin/keepalived --dont-fork
             ‚îî‚îÄ708 /usr/sbin/keepalived --dont-fork

Feb 02 16:07:10 rb-k8s-lb1 Keepalived_vrrp[708]: Registering Kernel netlink command channel
Feb 02 16:07:10 rb-k8s-lb1 Keepalived_vrrp[708]: Opening file '/etc/keepalived/keepalived.conf'.
Feb 02 16:07:10 rb-k8s-lb1 Keepalived_vrrp[708]: WARNING - default user 'keepalived_script' for script execution does not exist - please crea&gt;
Feb 02 16:07:10 rb-k8s-lb1 Keepalived_vrrp[708]: WARNING - script `killall` resolved by path search to `/usr/bin/killall`. Please specify ful&gt;
Feb 02 16:07:10 rb-k8s-lb1 Keepalived_vrrp[708]: SECURITY VIOLATION - scripts are being executed but script_security not enabled.
Feb 02 16:07:10 rb-k8s-lb1 Keepalived_vrrp[708]: Registering gratuitous ARP shared channel
Feb 02 16:07:10 rb-k8s-lb1 Keepalived_vrrp[708]: (haproxy-vip) Entering BACKUP STATE (init)
Feb 02 16:07:10 rb-k8s-lb1 Keepalived_vrrp[708]: VRRP_Script(chk_haproxy) succeeded
Feb 02 16:07:10 rb-k8s-lb1 Keepalived_vrrp[708]: (haproxy-vip) Changing effective priority from 100 to 102
Feb 02 16:07:14 rb-k8s-lb1 Keepalived_vrrp[708]: (haproxy-vip) Entering MASTER STATE
</code></pre><p>Status keepalived on rb-k8s-lb2:</p><pre><code>root@rb-k8s-lb2:~# sudo systemctl status keepalived.service 
‚óè keepalived.service - Keepalive Daemon (LVS and VRRP)
     Loaded: loaded (/lib/systemd/system/keepalived.service; enabled; vendor preset: enabled)
     Active: active (running) since Wed 2022-02-02 16:07:12 UTC; 1 weeks 3 days ago
   Main PID: 647 (keepalived)
      Tasks: 2 (limit: 4676)
     Memory: 6.6M
     CGroup: /system.slice/keepalived.service
             ‚îú‚îÄ647 /usr/sbin/keepalived --dont-fork
             ‚îî‚îÄ699 /usr/sbin/keepalived --dont-fork

Feb 02 16:07:13 rb-k8s-lb2 Keepalived_vrrp[699]: Registering Kernel netlink reflector
Feb 02 16:07:13 rb-k8s-lb2 Keepalived_vrrp[699]: Registering Kernel netlink command channel
Feb 02 16:07:13 rb-k8s-lb2 Keepalived_vrrp[699]: Opening file '/etc/keepalived/keepalived.conf'.
Feb 02 16:07:13 rb-k8s-lb2 Keepalived_vrrp[699]: WARNING - default user 'keepalived_script' for script execution does not exist - please crea&gt;
Feb 02 16:07:13 rb-k8s-lb2 Keepalived_vrrp[699]: WARNING - script `killall` resolved by path search to `/usr/bin/killall`. Please specify ful&gt;
Feb 02 16:07:13 rb-k8s-lb2 Keepalived_vrrp[699]: SECURITY VIOLATION - scripts are being executed but script_security not enabled.
Feb 02 16:07:13 rb-k8s-lb2 Keepalived_vrrp[699]: Registering gratuitous ARP shared channel
Feb 02 16:07:13 rb-k8s-lb2 Keepalived_vrrp[699]: (haproxy-vip) Entering BACKUP STATE (init)
Feb 02 16:07:13 rb-k8s-lb2 Keepalived_vrrp[699]: VRRP_Script(chk_haproxy) succeeded
Feb 02 16:07:13 rb-k8s-lb2 Keepalived_vrrp[699]: (haproxy-vip) Changing effective priority from 100 to 102
</code></pre><h2 id=high-availability-verification>High Availability Verification</h2><p>Before we create a kubernetes cluster we have to make sure our high availability configuration is working properly.</p><ol><li>Check the IP Address on the node rb-k8s-lb1:</li></ol><pre><code>root@rb-k8s-lb1:~# ip a
1: lo:  mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
    inet6 ::1/128 scope host 
       valid_lft forever preferred_lft forever
2: ens3:  mtu 1500 qdisc fq_codel state UP group default qlen 1000
    link/ether 52:54:00:72:9a:4b brd ff:ff:ff:ff:ff:ff
    inet 10.60.60.43/24 brd 10.60.60.255 scope global ens3
       valid_lft forever preferred_lft forever
    inet 10.60.60.45/24 scope global secondary ens3
       valid_lft forever preferred_lft forever
    inet6 fe80::5054:ff:fe72:9a4b/64 scope link 
       valid_lft forever preferred_lft forever
</code></pre><p>We can see that VIP 10.60.60.45 was successfully added to the node rb-k8s-lb1. then we simulate if node rb-k8s-lb1 is down, then VIP 10.60.60.45 should automatically move to node rb-k8s-lb2</p><ol start=2><li>We turn off the HAproxy service on the rb-k8s-lb1 node:</li></ol><pre><code>sudo systemctl stop haproxy.service
</code></pre><ol start=3><li>Then we check again the IP Address on the node rb-k8s-lb1:</li></ol><pre><code>root@rb-k8s-lb1:~# ip a
1: lo:  mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
    inet6 ::1/128 scope host 
       valid_lft forever preferred_lft forever
2: ens3:  mtu 1500 qdisc fq_codel state UP group default qlen 1000
    link/ether 52:54:00:72:9a:4b brd ff:ff:ff:ff:ff:ff
    inet 10.60.60.43/24 brd 10.60.60.255 scope global ens3
       valid_lft forever preferred_lft forever
    inet6 fe80::5054:ff:fe72:9a4b/64 scope link 
       valid_lft forever preferred_lft forever
</code></pre><p>At node rb-k8s-lb1 VIP 10.60.60.45 no longer exists, then we have to make sure if VIP is at node rb-k8s-lb2</p><ol start=4><li>Check the IP Address on the rb-k8s-lb2 node:</li></ol><pre><code>
root@rb-k8s-lb2:~# ip a
1: lo:  mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
    inet6 ::1/128 scope host 
       valid_lft forever preferred_lft forever
2: ens3:  mtu 1500 qdisc fq_codel state UP group default qlen 1000
    link/ether 52:54:00:aa:3d:02 brd ff:ff:ff:ff:ff:ff
    inet 10.60.60.44/24 brd 10.60.60.255 scope global ens3
       valid_lft forever preferred_lft forever
    inet 10.60.60.45/24 scope global secondary ens3
       valid_lft forever preferred_lft forever
    inet6 fe80::5054:ff:feaa:3d02/64 scope link 
       valid_lft forever preferred_lft forever
</code></pre><p>As per our expectation that VIP has moved to node rb-k8s-lb2 if simulated node rb-k8s-lb1 is dead by disabling haproxy service on rb-k8s-lb1.</p><ol start=5><li>Don&rsquo;t forget to start the haproxy service again on node rb-k82-lb1:</li></ol><pre><code>sudo systemctl start haproxy.service
</code></pre><p>In the next post we will continue with configuring the Kubernetes cluster using the VIP address we created earlier</p></div><div class="row pl-3 pr-3"><div class="col-md-6 share-buttons"><strong>Share on:</strong>
<a class="btn btn-sm facebook-btn" href="https://www.facebook.com/sharer.php?u=https%3a%2f%2fme.byamri.com%2fposts%2f3_kubernetes%2fcara-konfigurasi-ha%2fcara-konfigurasi-ha%2f" target=_blank><i class="fab fa-facebook"></i></a><a class="btn btn-sm twitter-btn" href="https://twitter.com/share?url=https%3a%2f%2fme.byamri.com%2fposts%2f3_kubernetes%2fcara-konfigurasi-ha%2fcara-konfigurasi-ha%2f&text=How%20to%20Configure%20High%20Availabilty%20Kubernetes%20Cluster%20on%20Ubuntu%2020.4&via=My%20Resume" target=_blank><i class="fab fa-twitter"></i></a><a class="btn btn-sm reddit-btn" href="https://reddit.com/submit?url=https%3a%2f%2fme.byamri.com%2fposts%2f3_kubernetes%2fcara-konfigurasi-ha%2fcara-konfigurasi-ha%2f&title=How%20to%20Configure%20High%20Availabilty%20Kubernetes%20Cluster%20on%20Ubuntu%2020.4" target=_blank><i class="fab fa-reddit"></i></a><a class="btn btn-sm linkedin-btn" href="https://www.linkedin.com/shareArticle?url=https%3a%2f%2fme.byamri.com%2fposts%2f3_kubernetes%2fcara-konfigurasi-ha%2fcara-konfigurasi-ha%2f&title=How%20to%20Configure%20High%20Availabilty%20Kubernetes%20Cluster%20on%20Ubuntu%2020.4" target=_blank><i class="fab fa-linkedin"></i></a><a class="btn btn-sm whatsapp-btn" href="https://api.whatsapp.com/send?text=How%20to%20Configure%20High%20Availabilty%20Kubernetes%20Cluster%20on%20Ubuntu%2020.4 https%3a%2f%2fme.byamri.com%2fposts%2f3_kubernetes%2fcara-konfigurasi-ha%2fcara-konfigurasi-ha%2f" target=_blank><i class="fab fa-whatsapp"></i></a><a class="btn btn-sm email-btn" href="mailto:?subject=How%20to%20Configure%20High%20Availabilty%20Kubernetes%20Cluster%20on%20Ubuntu%2020.4&body=https%3a%2f%2fme.byamri.com%2fposts%2f3_kubernetes%2fcara-konfigurasi-ha%2fcara-konfigurasi-ha%2f" target=_blank><i class="fas fa-envelope-open-text"></i></a></div><div class="col-md-6 btn-improve-page"><a href=https://github.com/RobyYasirAmri/robyyasiramri.github.io/edit/main/content/posts/3_kubernetes/cara-konfigurasi-ha/cara-konfigurasi-ha.md title="Improve this page" target=_blank rel=noopener><i class="fas fa-code-branch"></i>Improve this page</a></div></div><hr><div class="row next-prev-navigator"><div class="col-md-6 previous-article"><a href=/posts/2_openstack/artikel-1/artikel-1/ title="Openstack Introduction" class="btn btn-outline-info"><div><i class="fas fa-chevron-circle-left"></i>Prev</div><div class=next-prev-text>Openstack Introduction</div></a></div><div class="col-md-6 next-article"><a href=/posts/3_kubernetes/artikel-2/artikel-2/ title="Clustering Kubernetes using Kubeadm" class="btn btn-outline-info"><div>Next <i class="fas fa-chevron-circle-right"></i></div><div class=next-prev-text>Clustering Kubernetes using Kubeadm</div></a></div></div><hr></div></div></div><a id=scroll-to-top class=btn><i class="fas fa-chevron-circle-up"></i></a><div class="dropdown languageSelector"><a class="btn dropdown-toggle" href=# id=languageSelector role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false><span class="flag-icon flag-icon-gb"></span>English</a><div class=dropdown-menu aria-labelledby=languageSelector><a class="dropdown-item nav-link languages-item" href=/id/posts/3_kubernetes/cara-konfigurasi-ha/cara-konfigurasi-ha><span class="flag-icon flag-icon-id"></span>Indonesian</a></div></div></section><section class=toc-section id=toc-section><div class=toc-holder><h5 class="text-center pl-3">Table of Contents</h5><hr><div class=toc><nav id=TableOfContents><ul><li><a href=#architecture-clusters>Architecture Clusters.</a></li><li><a href=#load-balancing-configuration>Load Balancing Configuration:</a><ul><li><a href=#install-keepalive-and-haproxy-on-both-nodes>Install Keepalive and HAproxy on both nodes</a></li><li><a href=#keepalive-configuration>Keepalive Configuration</a></li></ul></li><li><a href=#high-availability-verification>High Availability Verification</a></li></ul></nav></div></div></section></div><footer class="container-fluid text-center align-content-center footer pb-2"><div class="container pt-5"><div class="row text-left"><div class="col-md-4 col-sm-12"><h5>Navigation</h5><ul><li class=nav-item><a class=smooth-scroll href=https://me.byamri.com#about>About</a></li><li class=nav-item><a class=smooth-scroll href=https://me.byamri.com#skills>Skills</a></li><li class=nav-item><a class=smooth-scroll href=https://me.byamri.com#experiences>Experiences</a></li><li class=nav-item><a class=smooth-scroll href=https://me.byamri.com#education>Education</a></li><li class=nav-item><a class=smooth-scroll href=https://me.byamri.com#projects>Projects</a></li><li class=nav-item><a class=smooth-scroll href=https://me.byamri.com#recent-posts>Recent Posts</a></li></ul></div><div class="col-md-4 col-sm-12"><h5>Contact me:</h5><ul><li><a href=mailto:roby@byamri.com target=_blank rel=noopener><span><i class="fas fa-envelope"></i></span><span>roby@byamri.com</span></a></li><li><span><i class="fas fa-phone-alt"></i></span><span>+6285155274275</span></li></ul></div><div class="col-md-4 col-sm-12"><p>Stay up to date with email notification</p><form action="https://github.us1.list-manage.com/subscribe/post?u=19de52a4603135aae97163fd8&amp;amp;id=094a24c76e" method=post id=mc-embedded-subscribe-form name=mc-embedded-subscribe-form class=validate target=_blank novalidate><div class=form-group><input type=email class=form-control id=mce-EMAIL name=EMAIL aria-describedby=emailHelp placeholder="Enter email">
<small id=emailHelp class="form-text text-muted">By entering your email address, you agree to receive the newsletter of this website.</small></div><button type=submit class="btn btn-info">Submit</button></form></div></div></div><hr><div class=container><p id=disclaimer><strong>Liability Notice:</strong> This theme is under MIT license. So, you can use it for non-commercial, commercial, or private uses. You can modify or distribute the theme without requiring any permission from the theme author. However, the theme author does not provide any warranty or takes any liability for any issue with the theme.</p></div><hr><div class=container><div class="row text-left"><div class=col-md-4><a id=theme href=https://github.com/hossainemruz/toha target=_blank rel=noopener><img src=/images/theme-logo_hu8376fd15465fef26ffe66b6bcf0ca686_13669_32x0_resize_box_2.png alt="Toha Theme Logo">
Toha</a></div><div class="col-md-4 text-center">¬© 2022 Copyright.</div><div class="col-md-4 text-right"><a id=hugo href=https://gohugo.io/ target=_blank rel=noopener>Powered by
<img src=/images/hugo-logo.svg alt="Hugo Logo" height=18></a></div></div></div></footer><script type=text/javascript src=/js/jquery-3.4.1.min.js></script><script type=text/javascript src=/js/popper.min.js></script><script type=text/javascript src=/js/bootstrap.min.js></script><script type=text/javascript src=/js/navbar.js></script><script type=text/javascript src=/js/plyr.js></script><script type=text/javascript src=/js/main.js></script><script type=text/javascript defer src=/js/katex.min.js></script><script type=text/javascript defer src=/js/auto-render.min.js onload=renderMathInElement(document.body);></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js></script><script src=/js/single.js></script><script>hljs.initHighlightingOnLoad();</script></body></html>